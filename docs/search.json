[{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"loglikelihood-adjustment-using-the-adjust_loglik-function","dir":"Articles","previous_headings":"","what":"Loglikelihood adjustment using the adjust_loglik function","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"function adjust_loglik returns object class chandwich: function can used evaluate \\(\\ell_I(\\theta)\\), \\(\\ell_{A2}(\\theta)\\) choices \\(\\ell_A(\\theta)\\). Functions take chandwich object argument vector argument type, equal one \"vertical\", \"cholesky\", \"spectral\", \"none\", select type adjustment. default type = \"vertical\". illustrate loglikelihood adjustments use functions chandwich using examples, starting simple model one parameter.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"binomial-model","dir":"Articles","previous_headings":"","what":"Binomial model","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"rats data (Tarone 1982) contain information experiment , 71 groups rats, total number rats group numbers rats develop tumor recorded. model data using binomial distribution, treating groups rats separate cluster. Bayesian analysis data based hierarchical binomial-beta model presented Section 5.3 Gelman et al. (2014). following code creates function returns vector loglikelihood contributions individual groups rats, calls adjust_loglik make adjustments, produces basic summary MLE unadjusted adjusted standard errors plots adjusted unadjusted loglikelihood. need supply argument cluster example default, observation (group rats) forms cluster applies .  one-dimensional case (horizontal) Cholesky spectral adjustments identical , range plot, vertical adjustment similar horizontal adjustments. Appreciable differences becomes apparent towards edges parameter space, behaviour vertical adjustment, approaches \\(-\\infty\\) \\(p\\) approaches 0 1, may preferable behaviour horizontal adjustments. expect example adjusted standard error slightly greater unadjusted standard error.","code":"library(chandwich) binom_loglik <- function(prob, data) {   if (prob < 0 || prob > 1) {     return(-Inf)    }    return(dbinom(data[, \"y\"], data[, \"n\"], prob, log = TRUE)) } # Make the adjustments rat_res <- adjust_loglik(loglik = binom_loglik, data = rats, par_names = \"p\") summary(rat_res) #>      MLE       SE adj. SE #> p 0.1535 0.008645 0.01305 plot(rat_res, type = 1:4, legend_pos = \"bottom\", lwd = 2, col = 1:4) plot(rat_res, type = 1:4, legend_pos = \"bottom\", lwd = 2, col = 1:4,       xlim = c(0, 1))"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"confidence-intervals","dir":"Articles","previous_headings":"Binomial model","what":"Confidence intervals","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"function conf_intervals calculates (profile, necessary) likelihood-based confidence intervals individual parameters, also provides symmetric intervals based normal approximation sampling distribution estimator. chandwich also confint S3 method, produces likelihood-based intervals.","code":"# 95% confidence intervals, unadjusted and vertically adjusted conf_intervals(rat_res, type = \"none\") #> Waiting for profiling to be done... #> Model: binom_loglik  #>  #> 95% confidence interval, independence loglikelihood #>  #> Symmetric: #>    lower   upper  #> p  0.1366  0.1705 #>  #> Likelihood-based: #>    lower   upper  #> p  0.1372  0.1710 conf_intervals(rat_res) #> Waiting for profiling to be done... #> Model: binom_loglik  #>  #> 95% confidence interval, adjusted loglikelihod with type = ''vertical''  #>  #> Symmetric: #>    lower   upper  #> p  0.1280  0.1791 #>  #> Likelihood-based: #>    lower   upper  #> p  0.1292  0.1802 confint(rat_res) #> Waiting for profiling to be done... #>       2.5 %    97.5 % #> p 0.1292236 0.1802395"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"extreme-value-modelling-of-maximum-temperatures","dir":"Articles","previous_headings":"","what":"Extreme value modelling of maximum temperatures","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"consider example presented Section 5.2 Chandler Bate (2007). owtemps data contain annual maximum temperatures Oxford Worthing U.K. 1901 1980, viewed 80 clusters independent observations bivariate distribution. construct independence loglikelihood based generalized extreme value (GEV) models marginal distributions Oxford Worthing. model parameterized marginal distribution Oxford GEV(\\(\\mu_0 + \\mu_1, \\sigma_0 + \\sigma_1, \\xi_0 + \\xi_1\\)) Worthing GEV(\\(\\mu_0 - \\mu_1, \\sigma_0 - \\sigma_1, \\xi_0 - \\xi_1\\)), GEV(\\(\\mu, \\sigma, \\xi\\)) denotes GEV distribution location \\(\\mu\\), scale \\(\\sigma\\) shape \\(\\xi\\). perform loglikelihood adjustment full six-parameter model reproduce relevant rows Table 2 Chandler Bate (2007).","code":"gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) } # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Perform the log-likelihood adjustment of the full model  par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names) # Rows 1, 3 and 4 of Table 2 of Chandler and Bate (2007) round(attr(large, \"MLE\"), 4) #>    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1]  #>  81.1702   2.6684   3.7291   0.5312  -0.1989  -0.0883 round(attr(large, \"SE\"), 4) #>    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1]  #>   0.3282   0.3282   0.2293   0.2293   0.0494   0.0494 round(attr(large, \"adjSE\"), 4) #>    mu[0]    mu[1] sigma[0] sigma[1]    xi[0]    xi[1]  #>   0.4036   0.2128   0.2426   0.1911   0.0394   0.0362"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"confidence-intervals-1","dir":"Articles","previous_headings":"Extreme value modelling of maximum temperatures","what":"Confidence intervals","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"use conf_intervals calculate profile likelihood-based confidence intervals parameters.","code":"# 95% confidence intervals, vertically adjusted conf_intervals(large) #> Waiting for profiling to be done... #> Model: gev_loglik  #>  #> 95% confidence intervals, adjusted loglikelihod with type = ''vertical''  #>  #> Symmetric: #>           lower     upper    #> mu[0]     80.37910  81.96121 #> mu[1]      2.25128   3.08552 #> sigma[0]   3.25368   4.20459 #> sigma[1]   0.15660   0.90574 #> xi[0]     -0.27623  -0.12166 #> xi[1]     -0.15939  -0.01731 #>  #> Profile likelihood-based: #>           lower     upper    #> mu[0]     80.37291  81.96021 #> mu[1]      2.24357   3.08287 #> sigma[0]   3.29922   4.25998 #> sigma[1]   0.16118   0.94338 #> xi[0]     -0.27410  -0.11572 #> xi[1]     -0.16519  -0.02002"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"confidence-regions","dir":"Articles","previous_headings":"Extreme value modelling of maximum temperatures","what":"Confidence regions","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"reproduce Figure 4(b) Chandler Bate (2007), adding 95% confidence region vertical adjustment.  95% contours profile adjusted loglikelihoods similar.","code":"which_pars <- c(\"sigma[0]\", \"sigma[1]\") gev_none <- conf_region(large, which_pars = which_pars, type = \"none\") #> Waiting for profiling to be done... gev_vertical <- conf_region(large, which_pars = which_pars) #> Waiting for profiling to be done... gev_cholesky <- conf_region(large, which_pars = which_pars, type = \"cholesky\") #> Waiting for profiling to be done... gev_spectral <- conf_region(large, which_pars = which_pars, type = \"spectral\") #> Waiting for profiling to be done... plot(gev_none, gev_cholesky, gev_vertical, gev_spectral, lwd = 2,      xlim = c(3.0, 4.5), ylim = c(-0.1, 1.25))"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"comparing-nested-models","dir":"Articles","previous_headings":"Extreme value modelling of maximum temperatures","what":"Comparing nested models","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"Suppose wish test null hypothesis Oxford Worthing share common GEV shape parameter, , \\(\\xi_1 = 0\\). call adjust_loglik using argument fixed_pars fix \\(\\xi_1\\) zero perform loglikelihood adjustment reduced model. use compare_models carry adjusted likelihood ratio test. approx = FALSE (default) equation (17) Section 3.3 Chandler Bate (2007) used. approx = TRUE approximation detailed equations (18)-(20) used. Alternatively, can call compare_models directly without first creating medium, using argument fixed_pars fix \\(\\xi_1\\) zero. case whether use approximate approach non-negligible effect \\(p\\)-value probably reject null either case. chandwich also anova S3 method compare nested models class \"chandwich\". perform loglikelihood adjustment models Oxford Worthing share common GEV scale shape parameters (small) share GEV parameters (tiny). perform pairwise comparisons neighbouring nest models using anova().","code":"medium <- adjust_loglik(larger = large, fixed_pars = \"xi[1]\") compare_models(large, medium) #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> test statistic = 6.356, df = 1, p-value = 0.0117 compare_models(large, medium, approx = TRUE) #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> Using using approximation (18) of Chandler and Bate (2007):  #> test statistic = 5.245, df = 1, p-value = 0.022 compare_models(large, fixed_pars = \"xi[1]\") #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> test statistic = 6.356, df = 1, p-value = 0.0117 small <- adjust_loglik(larger = large, fixed_pars = c(\"sigma[1]\", \"xi[1]\")) tiny <- adjust_loglik(larger = large, fixed_pars = c(\"mu[1]\", \"sigma[1]\", \"xi[1]\")) anova(large, medium, small, tiny) #> Analysis of (Adjusted) Deviance Table #>  #>        Model.Df Df  ALRTS Pr(>ALRTS)     #> large         6                          #> medium        5  1  6.356    0.01170 *   #> small         4  1  4.251    0.03924 *   #> tiny          3  1 81.714    < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 anova(large, medium, small, tiny, approx = TRUE) #> Analysis of (Adjusted) Deviance Table #>  #>        Model.Df Df   ALRTS Pr(>ALRTS)     #> large         6                           #> medium        5  1   5.245    0.02200 *   #> small         4  1   4.184    0.04081 *   #> tiny          3  1 112.822    < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"misspecified-poisson-model","dir":"Articles","previous_headings":"","what":"Misspecified Poisson model","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"repeat part example Section 5.1 Object-Oriented Computation Sandwich Estimators vignette sandwich package (Zeileis 2006), using simulated dataset. example illustrates sandwich estimators may result inferences robust certain types model misspecification. simulate data log-linear negative binomial regression model fit misspecified log-quadratic Poisson regression model. Although conditional mean y linear x overdispersion responses relative Poisson distribution contributes spurious significance quadratic term. adjust independence log-likelihood, observation forming cluster. adjusted standard errors agree sandwich vignette sufficiently larger unadjusted standard errors alleviate spurious significance quadratic term: \\(p\\)-value changes 0.034 0.18. full details please see sandwich vignette.","code":"set.seed(123) x <- rnorm(250) y <- rnbinom(250, mu = exp(1 + x), size = 1) fm_pois <- glm(y ~ x + I(x^2), family = poisson) round(summary(fm_pois)$coefficients, 3) #>             Estimate Std. Error z value Pr(>|z|) #> (Intercept)    1.063      0.041  25.709    0.000 #> x              0.996      0.054  18.606    0.000 #> I(x^2)        -0.049      0.023  -2.122    0.034 pois_glm_loglik <- function(pars, y, x) {   log_mu <- pars[1] + pars[2] * x + pars[3] * x ^ 2   return(dpois(y, lambda = exp(log_mu), log = TRUE)) } pars <- c(\"alpha\", \"beta\", \"gamma\") pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, par_names = pars) summary(pois_quad) #>            MLE      SE adj. SE #> alpha  1.06300 0.04136 0.08378 #> beta   0.99610 0.05354 0.10520 #> gamma -0.04913 0.02315 0.03628"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"confidence-intervals-2","dir":"Articles","previous_headings":"Misspecified Poisson model","what":"Confidence intervals","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"use conf_intervals calculate profile likelihood-based confidence intervals parameters.","code":"# 95% confidence intervals, vertically adjusted conf_intervals(pois_quad) #> Waiting for profiling to be done... #> Model: pois_glm_loglik  #>  #> 95% confidence intervals, adjusted loglikelihod with type = ''vertical''  #>  #> Symmetric: #>        lower     upper    #> alpha   0.89907   1.22747 #> beta    0.78986   1.20231 #> gamma  -0.12024   0.02199 #>  #> Profile likelihood-based: #>        lower    upper   #> alpha   0.8954   1.2232 #> beta    0.7877   1.1991 #> gamma  -0.1198   0.0222"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"confidence-regions-1","dir":"Articles","previous_headings":"Misspecified Poisson model","what":"Confidence regions","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"call adjust_loglik fix quadratic coefficient zero, producing model two free parameters, use conf_region calculate vertically adjusted unadjusted loglikelihoods grid plotting. plot illustrates way independence loglikelihood \\((\\alpha, \\beta)\\) scaled.","code":"pois_lin <- adjust_loglik(larger = pois_quad, fixed_pars = \"gamma\") pois_vertical <- conf_region(pois_lin) #> Waiting for profiling to be done... pois_none <- conf_region(pois_lin, type = \"none\") #> Waiting for profiling to be done... plot(pois_none, pois_vertical, conf = c(50, 75, 95, 99), col = 2:1, lwd = 2, lty = 1)"},{"path":"https://github.com/paulnorthrop/chandwich/articles/chandwich-vignette.html","id":"comparing-nested-models-1","dir":"Articles","previous_headings":"Misspecified Poisson model","what":"Comparing nested models","title":"Introducing chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment","text":"examine significance quadratic term using adjusted likelihood ratio test. \\(p\\)-value based equation (17) Chandler Bate (2007) agrees value sandwich vignette, based Wald test, \\(p\\)-value based equations (18)-(20) slightly different.","code":"compare_models(pois_quad, pois_lin) #> Model: pois_glm_loglik  #> H0: \"gamma\" = 0  #> HA: unrestricted model  #>  #> test statistic = 1.82, df = 1, p-value = 0.1773 compare_models(pois_quad, pois_lin, approx = TRUE) #> Model: pois_glm_loglik  #> H0: \"gamma\" = 0  #> HA: unrestricted model  #>  #> Using using approximation (18) of Chandler and Bate (2007):  #> test statistic = 1.921, df = 1, p-value = 0.1658"},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Paul J. Northrop. Author, maintainer, copyright holder. Richard E. Chandler. Author, copyright holder.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Northrop PJ, Chandler RE (2025). chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment. R package version 1.1.6, https://paulnorthrop.github.io/chandwich/.","code":"@Manual{,   title = {chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment},   author = {Paul J. Northrop and Richard E. Chandler},   year = {2025},   note = {R package version 1.1.6},   url = {https://paulnorthrop.github.io/chandwich/}, }"},{"path":[]},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/index.html","id":"what-does-chandwich-do","dir":"","previous_headings":"Chandler-Bate Sandwich Loglikelihood Adjustment","what":"What does chandwich do?","title":"Chandler-Bate Sandwich Loglikelihood Adjustment","text":"chandwich package performs adjustments independence loglikelihood using robust sandwich estimator parameter covariance matrix, based methodology Chandler Bate (2007). can used cluster correlated data interest lies parameters marginal distributions performing inferences robust certain types model misspecification. Functions profiling adjusted loglikelihoods also provided, functions calculating plotting confidence intervals, single model parameters, confidence regions, pairs model parameters. Nested models can compared using adjusted likelihood ratio test.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/index.html","id":"a-simple-example","dir":"","previous_headings":"Chandler-Bate Sandwich Loglikelihood Adjustment","what":"A simple example","title":"Chandler-Bate Sandwich Loglikelihood Adjustment","text":"main function chandwich package adjust_loglik. finds maximum likelihood estimate (MLE) model parameters based independence loglikelihood cluster dependence data ignored. independence loglikelihood adjusted way ensures Hessian adjusted loglikelihood coincides robust sandwich estimate parameter covariance MLE. Three adjustments available: one independence loglikelihood scaled (vertical scaling) two others scaling parameter vector (horizontal scaling). rats data contain information experiment , 71 groups rats, total number rats group numbers rats develop tumor recorded. model data using binomial distribution, treating group rats separate cluster. argument binom_loglik adjust_loglik function returns vector loglikelihood contributions group rats. one-dimensional examples like two adjustments using horizontal scaling identical, generally hold one dimension.","code":"binom_loglik <- function(prob, data) {   if (prob < 0 || prob > 1) {     return(-Inf)   }   return(dbinom(data[, \"y\"], data[, \"n\"], prob, log = TRUE)) } rat_res <- adjust_loglik(loglik = binom_loglik, data = rats) plot(rat_res, type = 1:4, legend_pos = \"bottom\", lwd = 2, col = 1:4)"},{"path":"https://github.com/paulnorthrop/chandwich/index.html","id":"installation","dir":"","previous_headings":"Chandler-Bate Sandwich Loglikelihood Adjustment","what":"Installation","title":"Chandler-Bate Sandwich Loglikelihood Adjustment","text":"get current released version CRAN:","code":"install.packages(\"chandwich\")"},{"path":"https://github.com/paulnorthrop/chandwich/index.html","id":"vignette","dir":"","previous_headings":"Chandler-Bate Sandwich Loglikelihood Adjustment","what":"Vignette","title":"Chandler-Bate Sandwich Loglikelihood Adjustment","text":"See vignette(\"chandwich-vignette\", package = \"chandwich\") overview package.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"Performs adjustments user-supplied independence loglikelihood presence cluster dependence, following Chandler Bate (2007). user provides function returns vector observation-specific loglikelihood contributions vector indicates cluster membership. loglikelihood sub-model can adjusted fixing set parameters particular values.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"","code":"adjust_loglik(   loglik = NULL,   ...,   cluster = NULL,   p = NULL,   init = NULL,   par_names = NULL,   fixed_pars = NULL,   fixed_at = 0,   name = NULL,   larger = NULL,   alg_deriv = NULL,   alg_hess = NULL,   mle = NULL,   H = NULL,   V = NULL )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"loglik named function.  Returns vector loglikelihood contributions individual observations.  first argument must vector model parameter(s). model parameters --bounds loglik return either -Inf vector least one element equal -Inf. number parameters full model must specified using (least) one arguments p, init par_names. ... arguments passed either loglik (alg_deriv alg_hess supplied) optim.  latter may include gr, method, lower, upper control. call optim, hessian = TRUE used regardless value supplied. function loglik must arguments names match arguments optim. cluster vector factor indicating cluster respective loglikelihood contributions loglik originate. Must length vector returned loglik. cluster supplied set inside adjust_loglik assumption observation forms cluster. p numeric scalar.  dimension full parameter vector, .e. number parameters full model.  Must consistent lengths init par_names, also supplied. init numeric vector initial values.  Must length equal number parameters full model.  init supplied p set length(init), provided consistent value given p implied length(par_names). fixed_pars NULL init[-fixed_pars] used search MLE. init supplied rep(0.1, p) used. par_names character vector.  Names p parameters full model.  Must consistent lengths init p, also supplied. fixed_pars vector specifying parameters restricted equal value(s) fixed_at.  Can either numeric vector, specifying indices components full parameter vector, character vector parameter names, must subset supplied par_names stored object larger. fixed_at numeric vector length 1 length(fixed_pars). length(fixed_at) = 1 components fixed_pars parameter vector fixed fixed_at. length(fixed_at) = length(fixed_pars) component fixed_pars[] fixed fixed_at[] . name character scalar.  name model gives rise loglik.  supplied name larger used, supplied, name function loglik otherwise. larger relevant fixed_pars NULL.   larger supplied fixed_pars error   result.  larger supplied information   model larger, e.g. p par_names   override attempt set arguments call   adjust_loglik. object class \"chandwich\" returned adjust_loglik,   corresponding model smaller model implied   fixed_pars nested.  larger supplied   arguments adjust_loglik apart   fixed_pars fixed_at extracted larger.   init supplied current call   adjust_loglik init set   attr(larger, \"MLE\"), elements fixed_pars   set fixed_at. alg_deriv function vector model parameter(s) first argument.  Returns length(cluster) p numeric matrix. Column contains derivatives loglikelihood contributions loglik respect model parameter . alg_hess function vector model parameter(s)   first argument.  Returns p p numeric matrix equal   Hessian loglik, .e. matrix second derivatives   function loglik. Supplying V alg_deriv H   alg_hess produce error. mle numeric vector.  Can used fixed_pars = NULL. Provides maximum likelihood estimate model parameters, , value parameter vector independence loglikelihood loglik maximized. Must length equal number parameters full model.  mle supplied p set length(mle), provided consistent value given p implied length(par_names). mle supplied overrides init. H, V p p numeric matrices.  used mle supplied.   Provide estimates Hessian   independence loglikelihood (H) variance vector   cluster-specific contributions score vector (first   derivatives respect parameters) independence   loglikelihood, evaluated MLE mle.  See   Introducing chandwich vignette /Chandler Bate (2007). Supplying V alg_deriv H   alg_hess produce error.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"function class \"chandwich\" evaluate adjusted   loglikelihood, independence loglikelihood, one sets   model parameters, arguments x numeric vector matrix giving values p_current     (see ) parameters model returned adjusted     loglikelihood applies.     p_current = 1 may numeric vector matrix     1 column.     p_current > 1 may numeric vector length p     (one set model parameters) numeric matrix p     columns (nrow(x) sets model parameters), one set row     x. type character scalar.  type adjustment use.     One \"vertical\", \"cholesky\", \"spectral\"     \"none\". latter results evaluation     (unadjusted) independence loglikelihood.   function (additional) attributes p_full, p_current number parameters full model     current models, respectively. free_pars numeric vector giving indices free     parameters current model, names inferred     par_names supplied. MLE, res_MLE Numeric vectors, names inferred     par_names supplied.  Maximum likelihood estimates     free parameters current model (mle)     parameters full model, including parameters fixed     values (res_MLE). SE, adjSE unadjusted adjusted estimated standard errors,     free parameters, respectively. VC, adjVC unadjusted adjusted estimated     variance-covariance matrix free parameters, respectively. HI, HA Hessians independence adjusted loglikelihood,     respectively. C_cholesky, C_spectral matrix C equation (14) Chandler     Bate (2007), calculated using Cholesky decomposition spectral     decomposition, respectively. full_par_names, par_names names parameters full     current models, respectively, supplied     call previous call. max_loglik common maximised value independence     adjusted loglikelihoods. loglik, cluster arguments loglik cluster     supplied call, previous call. loglik_args list containing arguments passed     loglik via ... call, previous call. loglikVecMLE vector containing contributions individual     observations independence log-likelihood evaluated MLE. name argument name, name function     loglik name supplied. nobs number observations. call call adjust_loglik. fixed_pars NULL attributes fixed_pars argument fixed_pars, names inferred     par_names supplied. fixed_at argument fixed_at, names inferred     par_names supplied. alg_deriv /alg_hess supplied   returned attributes. view individual attribute called att_name use   attr(x, \"att_name\") attributes(x)$att_name.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"Three adjustments independence loglikelihood described   Chandler Bate (2007) available.  vertical adjustment   described Section 6 two horizontal adjustments described   Sections 3.2 3.4.  See descriptions type ,   horizontal adjustments, descriptions C_cholesky   C_spectral, Value. adjustments involve first second derivatives loglikelihood   respect model parameters.  estimated using   jacobian optimHess   unless alg_deriv /alg_hess supplied.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"Chandler, R. E. Bate, S. (2007). Inference clustered   data using independence loglikelihood. Biometrika,   94(1), 167-183. doi:10.1093/biomet/asm015","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/adjust_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Loglikelihood adjustment using the sandwich estimator — adjust_loglik","text":"","code":"# ------------------------- Binomial model, rats data ----------------------  # Contributions to the independence loglikelihood binom_loglik <- function(prob, data) {   if (prob < 0 || prob > 1) {     return(-Inf)   }   return(dbinom(data[, \"y\"], data[, \"n\"], prob, log = TRUE)) } rat_res <- adjust_loglik(loglik = binom_loglik, data = rats, par_names = \"p\")  # Plot the loglikelihoods plot(rat_res, type = 1:4, legend_pos = \"bottom\", lwd = 2, col = 1:4)  # MLE, SEs and adjusted SEs summary(rat_res) #>      MLE       SE adj. SE #> p 0.1535 0.008645 0.01305  # -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  # Contributions to the independence loglikelihood gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Loglikelihood adjustment for the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names) # Rows 1, 3 and 4 of Table 2 of Chandler and Bate (2007) t(summary(large)) #>           mu[0]  mu[1] sigma[0] sigma[1]    xi[0]    xi[1] #> MLE     81.1700 2.6680   3.7290   0.5312 -0.19890 -0.08835 #> SE       0.3282 0.3282   0.2293   0.2293  0.04937  0.04937 #> adj. SE  0.4036 0.2128   0.2426   0.1911  0.03943  0.03625  # Loglikelihood adjustment of some smaller models: xi[1] = 0 etc  # Starting from a larger model medium <- adjust_loglik(larger = large, fixed_pars = \"xi[1]\") small <- adjust_loglik(larger = large, fixed_pars = c(\"sigma[1]\", \"xi[1]\")) small <- adjust_loglik(larger = medium, fixed_pars = c(\"sigma[1]\", \"xi[1]\"))  # Starting from scratch medium <- adjust_loglik(gev_loglik, data = owtemps, init = init,           par_names = par_names, fixed_pars = \"xi[1]\") small <- adjust_loglik(gev_loglik, data = owtemps, init = init,          par_names = par_names, fixed_pars = c(\"sigma[1]\", \"xi[1]\"))  # --------- Misspecified Poisson model for negative binomial data ----------  # ... following Section 5.1 of the \"Object-Oriented Computation of Sandwich # Estimators\" vignette of the sandwich package # https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-OOP.pdf  # Simulate data set.seed(123) x <- rnorm(250) y <- rnbinom(250, mu = exp(1 + x), size = 1) # Fit misspecified Poisson model fm_pois <- glm(y ~ x + I(x^2), family = poisson) summary(fm_pois)$coefficients #>                Estimate Std. Error   z value      Pr(>|z|) #> (Intercept)  1.06326821 0.04135723 25.709367 9.184267e-146 #> x            0.99607219 0.05353446 18.606186  2.862861e-77 #> I(x^2)      -0.04912373 0.02314608 -2.122335  3.380961e-02  # Contributions to the independence loglikelihood pois_glm_loglik <- function(pars, y, x) {   log_mu <- pars[1] + pars[2] * x + pars[3] * x ^ 2   return(dpois(y, lambda = exp(log_mu), log = TRUE)) } pars <- c(\"alpha\", \"beta\", \"gamma\") pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, par_names = pars) summary(pois_quad) #>            MLE      SE adj. SE #> alpha  1.06300 0.04136 0.08378 #> beta   0.99610 0.05354 0.10520 #> gamma -0.04913 0.02315 0.03628  # Providing algebraic derivatives and Hessian pois_alg_deriv <- function(pars, y, x) {   mu <- exp(pars[1] + pars[2] * x + pars[3] * x ^ 2)   return(cbind(y - mu, x * (y - mu), x ^2 * (y - mu))) } pois_alg_hess <- function(pars, y, x) {   mu <- exp(pars[1] + pars[2] * x + pars[3] * x ^ 2)   alg_hess <- matrix(0, 3, 3)   alg_hess[1, ] <- -c(sum(mu), sum(x * mu), sum(x ^ 2 * mu))   alg_hess[2, ] <- -c(sum(x * mu), sum(x ^ 2 * mu), sum(x ^ 3 * mu))   alg_hess[3, ] <- -c(sum(x ^ 2 * mu), sum(x ^ 3 * mu), sum(x ^ 4 * mu))   return(alg_hess) } pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, p = 3,                            alg_deriv = pois_alg_deriv, alg_hess = pois_alg_hess) summary(pois_quad) #>        MLE      SE adj. SE #> 1  1.06300 0.04136 0.08378 #> 2  0.99610 0.05354 0.10520 #> 3 -0.04913 0.02315 0.03628  got_sandwich <- requireNamespace(\"sandwich\", quietly = TRUE) if (got_sandwich) {   # Providing MLE, H and V   # H and V calculated using bread() and meat() from sandwich package   n_obs <- stats::nobs(fm_pois)   pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, p = 3,                              mle = fm_pois$coefficients,                              H = -solve(sandwich::bread(fm_pois) / n_obs),                              V = sandwich::meat(fm_pois) * n_obs) }"},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Comparison of nested models — anova.chandwich","title":"Comparison of nested models — anova.chandwich","text":"anova method objects class \"chandwich\". Compares two nested models using adjusted likelihood ratio test statistic (ALRTS) described Section 3.5 Chandler Bate (2007). nesting must result simple constraint subset parameters larger model held fixed.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Comparison of nested models — anova.chandwich","text":"","code":"# S3 method for class 'chandwich' anova(object, object2, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Comparison of nested models — anova.chandwich","text":"object object class \"chandwich\", returned adjust_loglik. object2 object class \"chandwich\", returned adjust_loglik. ... objects class \"chandwich\" /arguments passed compare_models.  name object class \"chandwich\" passed via ... must match argument compare_models argument optim.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Comparison of nested models — anova.chandwich","text":"object class \"anova\" inheriting class  \"data.frame\", four columns: Model.Df number parameters model Df decrease number parameter compared model       previous row ALRTS adjusted likelihood ratio test statistic Pr(>ALRTS) p-value associated test       model valid simplification model previous row. row names names model objects.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Comparison of nested models — anova.chandwich","text":"details adjusted likelihood ratio test see compare_models Chandler Bate (2007). objects class \"chandwich\" need provided nested   order: ordered inside anova.chandwich based   values attr(., \"p_current\").","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Comparison of nested models — anova.chandwich","text":"Chandler, R. E. Bate, S. (2007). Inference clustered   data using independence loglikelihood. Biometrika,   94(1), 167-183. doi:10.1093/biomet/asm015","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/anova.chandwich.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Comparison of nested models — anova.chandwich","text":"","code":"# -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,          par_names = par_names)  # Log-likelihood adjustment of some smaller models: xi[1] = 0 etc  medium <- adjust_loglik(larger = large, fixed_pars = \"xi[1]\") small <- adjust_loglik(larger = medium, fixed_pars = c(\"sigma[1]\", \"xi[1]\")) tiny <- adjust_loglik(larger = small,                       fixed_pars = c(\"mu[1]\", \"sigma[1]\", \"xi[1]\"))  anova(large, medium, small, tiny) #> Analysis of (Adjusted) Deviance Table #>  #>        Model.Df Df  ALRTS Pr(>ALRTS)     #> large         6                          #> medium        5  1  6.356    0.01170 *   #> small         4  1  4.251    0.03924 *   #> tiny          3  1 81.713    < 2e-16 *** #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://github.com/paulnorthrop/chandwich/reference/chandwich-package.html","id":null,"dir":"Reference","previous_headings":"","what":"chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment — chandwich-package","title":"chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment — chandwich-package","text":"Performs adjustments independence loglikelihood using robust sandwich estimator parameter covariance matrix, based methodology Chandler Bate (2007).  can used cluster correlated data interest lies parameters marginal distributions. Functions profiling adjusted loglikelihoods also provided, functions calculating plotting confidence intervals, single model parameters, confidence regions, pairs model parameters.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/chandwich-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment — chandwich-package","text":"main function chandwich package adjust_loglik.  finds maximum likelihood estimate (MLE) model parameters based independence loglikelihood cluster dependence data ignored.  independence loglikelihood adjusted way ensures Hessian adjusted loglikelihood coincides robust sandwich estimate parameter covariance MLE.  Three adjustments available: one independence loglikelihood scaled (vertical scaling) two others scaling parameter vector (horizontal scaling). See Chandler Bate (2007) full details vignette(\"chandwich-vignette\", package = \"chandwich\") overview package.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/chandwich-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment — chandwich-package","text":"Chandler, R. E. Bate, S. (2007). Inference clustered   data using independence loglikelihood. Biometrika,   94(1), 167-183. doi:10.1093/biomet/asm015","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/chandwich-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"chandwich: Chandler-Bate Sandwich Loglikelihood Adjustment — chandwich-package","text":"Maintainer: Paul J. Northrop p.northrop@ucl.ac.uk [copyright holder] Authors: Richard E. Chandler [copyright holder]","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/coef.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract model coefficients method for objects of class ","title":"Extract model coefficients method for objects of class ","text":"coef method class \"chandwich\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/coef.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract model coefficients method for objects of class ","text":"","code":"# S3 method for class 'chandwich' coef(object, complete = FALSE, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/coef.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract model coefficients method for objects of class ","text":"object object class \"chandwich\", result call adjust_loglik. complete logical scalar.  complete = TRUE   full vector parameter estimates returned, including fixed   using fixed_pars fixed_at call   adjust_loglik.  Otherwise, vector estimates   free parameters returned. default complete = FALSE, sync   vcov.chandwich. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/coef.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract model coefficients method for objects of class ","text":"numeric vector estimated parameters,  named names provided call  adjust_loglik.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/coef.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract model coefficients method for objects of class ","text":"full vector estimates taken attributes(object)$res_MLE reduced vector attributes(object)$MLE.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Comparison of nested models — compare_models","title":"Comparison of nested models — compare_models","text":"Compares nested models using adjusted likelihood ratio test statistic (ALRTS) described Section 3.5 Chandler Bate (2007). nesting must result simple constraint subset parameters larger model held fixed.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Comparison of nested models — compare_models","text":"","code":"compare_models(   larger,   smaller = NULL,   approx = FALSE,   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   fixed_pars = NULL,   fixed_at = rep_len(0, length(fixed_pars)),   init = NULL,   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Comparison of nested models — compare_models","text":"larger object class \"chandwich\" returned adjust_loglik.  larger two models. smaller object class \"chandwich\" returned   adjust_loglik.  smaller two models. smaller supplied arguments fixed_pars   fixed_at described ignored. approx logical scalar.  approx = TRUE   approximation detailed equations (18)-(20) Chandler Bate (2007)   used.  option available smaller supplied.   smaller supplied approx = TRUE used,   warning. approximation make sense type = \"none\".    type = \"none\" approx = TRUE approx   set FALSE warning. approx = FALSE adjusted likelihood   maximised restriction imposed delta, ,   equation (17) Chandler Bate (2007) used. type character scalar.  argument type function returned adjust_loglik, , type adjustment made independence loglikelihood function. fixed_pars numeric vector.  Indices components full parameter vector restricted equal value(s) fixed_at. fixed_at numeric vector length 1 length(fixed_pars). length(fixed_at) = 1 components fixed_pars parameter vector fixed fixed_at. length(fixed_at) = length(fixed_pars) component fixed_pars[] fixed fixed_at[] . init (relevant approx = FALSE). numeric vector initial values use search MLE smaller model.  Must length equal number parameters smaller two models compared.  init supplied, wrong length, attr(smaller, \"MLE\") used smaller supplied attr(larger, \"MLE\")[-fixed_pars] otherwise. ... arguments passed optim. may include gr, method, lower, upper control.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Comparison of nested models — compare_models","text":"object class \"compmod\", list components alrts adjusted likelihood ratio test statistic. df null hypothesis smaller model valid    simplification larger model adjusted likelihood ratio    test statistic chi-squared distribution df    degrees freedom. p_value p-value associated test null    hypothesis. larger_mle MLE parameters larger model. smaller_mle MLE parameters smaller model. larger_fixed_pars, smaller_fixed_pars Numeric vectors    indices parameters fixed larger smaller models,    respectively. larger_fixed_at, smaller_fixed_at Numeric vectors    values parameters larger_fixed_pars    smaller_fixed_pars fixed. approx argument approx.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Comparison of nested models — compare_models","text":"smaller two models specified either supplying   smaller fixed_pars.  supplied   smaller takes precedence. full details see Section 3.5 Chandler Bate (2007).   approx = FALSE likelihood ratio test null   hypothesis smaller model valid simplification larger   model carried directly using equation (17) Chandler Bate   (2007) based adjusted loglikelihood larger model,   returned adjust_loglik.  adjusted loglikelihood   maximised subject constraint subset parameters   larger model fixed.  smaller supplied   maximisation can avoided using approximation   detailed equations (18)-(20) Chandler Bate (2007), uses   MLE smaller model.  null distribution (chi-squared   degrees freedom equal number parameters fixed)   used cases.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Comparison of nested models — compare_models","text":"Chandler, R. E. Bate, S. (2007). Inference clustered   data using independence loglikelihood. Biometrika,   94(1), 167-183. doi:10.1093/biomet/asm015","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/compare_models.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Comparison of nested models — compare_models","text":"","code":"# -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,          par_names = par_names)  # Log-likelihood adjustment of some smaller models: xi[1] = 0 etc  medium <- adjust_loglik(larger = large, fixed_pars = \"xi[1]\") small <- adjust_loglik(larger = medium, fixed_pars = c(\"sigma[1]\", \"xi[1]\"))  # Tests  # Test xi1 = 0 (2 equivalent ways), vertical adjustment compare_models(large, fixed_pars = \"xi[1]\") #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> test statistic = 6.356, df = 1, p-value = 0.0117 compare_models(large, medium) #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> test statistic = 6.356, df = 1, p-value = 0.0117 # Test xi1 = 0, using approximation compare_models(large, medium, approx = TRUE) #> Model: gev_loglik  #> H0: \"xi[1]\" = 0  #> HA: unrestricted model  #>  #> Using using approximation (18) of Chandler and Bate (2007):  #> test statistic = 5.245, df = 1, p-value = 0.022  # Horizontal adjustments compare_models(large, medium, type = \"cholesky\")$p_value #> [1] 0.01593336 compare_models(large, medium, type = \"spectral\")$p_value #> [1] 0.01229833 # No adjustment (independence loglikelihood) compare_models(large, medium, type = \"none\")$p_value #> [1] 0.074199  # Test sigma1 = 0 for model with xi1 = 0 compare_models(medium, small) #> Model: gev_loglik  #> H0: (\"sigma[1]\", \"xi[1]\") = (0, 0)  #> HA: \"xi[1]\" = 0  #>  #> test statistic = 4.251, df = 1, p-value = 0.03924 # Test sigma1 = xi1 = 0 compare_models(large, small) #> Model: gev_loglik  #> H0: (\"sigma[1]\", \"xi[1]\") = (0, 0)  #> HA: unrestricted model  #>  #> test statistic = 8.6, df = 2, p-value = 0.01357  # --------- Misspecified Poisson model for negative binomial data ----------  # ... following Section 5.1 of the \"Object-Oriented Computation of Sandwich # Estimators\" vignette of the sandwich package # https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-OOP.pdf  # Simulate data set.seed(123) x <- rnorm(250) y <- rnbinom(250, mu = exp(1 + x), size = 1) # Fit misspecified Poisson model fm_pois <- glm(y ~ x + I(x^2), family = poisson) summary(fm_pois)$coefficients #>                Estimate Std. Error   z value      Pr(>|z|) #> (Intercept)  1.06326821 0.04135723 25.709367 9.184267e-146 #> x            0.99607219 0.05353446 18.606186  2.862861e-77 #> I(x^2)      -0.04912373 0.02314608 -2.122335  3.380961e-02  # Contributions to the independence loglikelihood pois_glm_loglik <- function(pars, y, x) {   log_mu <- pars[1] + pars[2] * x + pars[3] * x ^ 2   return(dpois(y, lambda = exp(log_mu), log = TRUE)) } pars <- c(\"alpha\", \"beta\", \"gamma\") pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, par_names = pars) summary(pois_quad) #>            MLE      SE adj. SE #> alpha  1.06300 0.04136 0.08378 #> beta   0.99610 0.05354 0.10520 #> gamma -0.04913 0.02315 0.03628  pois_lin <- adjust_loglik(larger = pois_quad, fixed_pars = \"gamma\")  # Test the significance of the quadratic term compare_models(pois_quad, pois_lin)$p_value #> [1] 0.1772841 compare_models(pois_quad, pois_lin, approx = TRUE)$p_value #> [1] 0.1657919"},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for model parameters — confint.chandwich","title":"Confidence intervals for model parameters — confint.chandwich","text":"confint method objects class \"chandwich\". Computes confidence intervals one model parameters based object returned adjust_loglik.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for model parameters — confint.chandwich","text":"","code":"# S3 method for class 'chandwich' confint(   object,   parm,   level = 0.95,   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   profile = TRUE,   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for model parameters — confint.chandwich","text":"object object class \"chandwich\", returned adjust_loglik. parm vector specifying (unfixed) parameters   confidence intervals required.   missing, parameters included. Can either numeric vector,   specifying indices components full parameter   vector, character vector parameter names, must subset   supplied par_names call   adjust_loglik produced object. parm must parameters common   attr(object, \"fixed_pars\").  parm must contain   unfixed parameters, .e. point profiling   unfixed parameters. level confidence level required.  numeric scalar (0, 1). type character scalar.  argument type function returned adjust_loglik, , type adjustment made independence loglikelihood function. profile logical scalar. TRUE confidence intervals based (adjusted) profile loglikelihood returned.  FALSE intervals based approximate large sample normal theory, symmetric MLE, returned. ... arguments passed conf_intervals.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for model parameters — confint.chandwich","text":"matrix columns giving lower upper confidence limits   parameter. labelled (1 - level)/2   1 - (1 - level)/2 % (default 2.5% 97.5%).   row names names model parameters,   available.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence intervals for model parameters — confint.chandwich","text":"details see documentation function   conf_intervals, confint.chandwich based.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/confint.chandwich.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals for model parameters — confint.chandwich","text":"","code":"# -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names) confint(large) #> Waiting for profiling to be done... #>               2.5 %      97.5 % #> mu[0]    80.3729113 81.96020651 #> mu[1]     2.2435715  3.08287072 #> sigma[0]  3.2992230  4.25997602 #> sigma[1]  0.1611821  0.94337677 #> xi[0]    -0.2740991 -0.11571585 #> xi[1]    -0.1651864 -0.02001604 confint(large, profile = FALSE) #>               2.5 %      97.5 % #> mu[0]    80.3790976 81.96120586 #> mu[1]     2.2512784  3.08552167 #> sigma[0]  3.2536759  4.20458854 #> sigma[1]  0.1565970  0.90573598 #> xi[0]    -0.2762342 -0.12166268 #> xi[1]    -0.1593869 -0.01730812"},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals — conf_intervals","title":"Confidence intervals — conf_intervals","text":"Calculates confidence intervals individual parameters.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals — conf_intervals","text":"","code":"conf_intervals(   object,   which_pars = NULL,   init = NULL,   conf = 95,   mult = 1.5,   num = 10,   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   profile = TRUE,   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals — conf_intervals","text":"object object class \"chandwich\" returned adjust_loglik. which_pars vector specifying (unfixed) parameters   confidence intervals required.  Can either numeric vector,   specifying indices components full parameter   vector, character vector parameter names, must subset   supplied par_names call   adjust_loglik produced object. which_pars must parameters common   attr(object, \"fixed_pars\").  which_pars must contain   unfixed parameters, .e. point profiling   unfixed parameters. missing, parameters included. init numeric vector initial estimates values parameters fixed which_pars. length attr(object, \"p_current\") - length(which_pars). init NULL wrong length relevant components MLE stored object used. conf numeric scalar (0, 100). Confidence level intervals. mult numeric vector length 1 length which_pars. search profile loglikelihood-based confidence limits conducted corresponding symmetric confidence intervals (based approximate normal theory), extended factor corresponding component mult. num numeric scalar.  number values evaluate profile loglikelihood either side MLE.  Increasing num increases accuracy confidence limits, code take longer run. type character scalar.  argument type function returned adjust_loglik, , type adjustment made independence loglikelihood function. profile logical scalar.  FALSE intervals based approximate large sample normal theory, symmetric MLE, returned (sym_CI) prof_CI returned object contain NAs. ... arguments passed optim. may include gr, method, lower, upper control.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals — conf_intervals","text":"object class \"confint\", list components conf argument conf. cutoff numeric scalar.  values inside       confidence interval profile loglikelihood lies       cutoff. parameter_vals, prof_loglik_vals 2 * num + 1       length(which_pars) numeric matrices.       Column parameter_vals contains profiled values       parameter which_par[].  Column prof_loglik_vals       contains corresponding values profile loglikelihood. sym_CI, prof_CI length(which_pars)       2 numeric matrices.  Row sym_CI (prof_CI)       contains symmetric (profile loglikelihood-based) confidence       intervals parameter which_pars[]. value       prof_CI NA means search       confidence limit extend far enough.  remedy increase       value mult, relevant component mult,       perhaps also increase num. max_loglik value adjusted loglikelihood       maximum, stored object$max_loglik. type argument type supplied call       conf_intervals, .e. type loglikelihood adjustment. which_pars argument which_pars. name character scalar. name model,       stored attr(object, \"name\"). p_current number free parameters current model. fixed_pars, fixed_at attr(object, \"fixed_pars\")       attr(object, \"fixed_at\"), arguments fixed_pars       fixed_at adjust_loglik,       supplied.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Confidence intervals — conf_intervals","text":"Calculates (profile, necessary) likelihood-based confidence   intervals individual parameters, also provides symmetric intervals   based normal approximation sampling distribution   estimator.  See also S3 confint method   confint.chandwich.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_intervals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Confidence intervals — conf_intervals","text":"","code":"# ------------------------- Binomial model, rats data ----------------------  # Contributions to the independence loglikelihood binom_loglik <- function(prob, data) {   if (prob < 0 || prob > 1) {     return(-Inf)   }   return(dbinom(data[, \"y\"], data[, \"n\"], prob, log = TRUE)) } rat_res <- adjust_loglik(loglik = binom_loglik, data = rats, par_names = \"p\")  # 95% likelihood-based confidence intervals, vertically adjusted ci <- conf_intervals(rat_res) #> Waiting for profiling to be done... plot(ci)  # Unadjusted conf_intervals(rat_res, type = \"none\") #> Waiting for profiling to be done... #> Model: binom_loglik  #>  #> 95% confidence interval, independence loglikelihood #>  #> Symmetric: #>    lower   upper  #> p  0.1366  0.1705 #>  #> Likelihood-based: #>    lower   upper  #> p  0.1372  0.1710  # -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names)  # 95% likelihood-based confidence intervals, vertically adjusted large_v <- conf_intervals(large, which_pars = c(\"xi[0]\", \"xi[1]\")) #> Waiting for profiling to be done... large_v #> Model: gev_loglik  #>  #> 95% confidence intervals, adjusted loglikelihod with type = ''vertical''  #>  #> Symmetric: #>        lower     upper    #> xi[0]  -0.27623  -0.12166 #> xi[1]  -0.15939  -0.01731 #>  #> Profile likelihood-based: #>        lower     upper    #> xi[0]  -0.27410  -0.11572 #> xi[1]  -0.16519  -0.02002 plot(large_v)  plot(large_v, which_par = \"xi[1]\")  # \\donttest{ # Unadjusted large_none <- conf_intervals(large, which_pars = c(\"xi[0]\", \"xi[1]\"),                              type = \"none\") #> Waiting for profiling to be done... large_none #> Model: gev_loglik  #>  #> 95% confidence intervals, independence loglikelihood #>  #> Symmetric: #>        lower      upper     #> xi[0]  -0.295708  -0.102188 #> xi[1]  -0.185107   0.008412 #>  #> Profile likelihood-based: #>        lower      upper     #> xi[0]  -0.289574  -0.094328 #> xi[1]  -0.188502   0.008628 plot(large_v, large_none)  plot(large_v, large_none, which_par = \"xi[1]\")  # }  # --------- Misspecified Poisson model for negative binomial data ----------  # ... following Section 5.1 of the \"Object-Oriented Computation of Sandwich # Estimators\" vignette of the sandwich package # https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-OOP.pdf  # Simulate data set.seed(123) x <- rnorm(250) y <- rnbinom(250, mu = exp(1 + x), size = 1) # Fit misspecified Poisson model fm_pois <- glm(y ~ x + I(x^2), family = poisson) summary(fm_pois)$coefficients #>                Estimate Std. Error   z value      Pr(>|z|) #> (Intercept)  1.06326821 0.04135723 25.709367 9.184267e-146 #> x            0.99607219 0.05353446 18.606186  2.862861e-77 #> I(x^2)      -0.04912373 0.02314608 -2.122335  3.380961e-02  # Contributions to the independence loglikelihood pois_glm_loglik <- function(pars, y, x) {   log_mu <- pars[1] + pars[2] * x + pars[3] * x ^ 2   return(dpois(y, lambda = exp(log_mu), log = TRUE)) } pars <- c(\"alpha\", \"beta\", \"gamma\") pois_quad <- adjust_loglik(pois_glm_loglik, y = y, x = x, par_names = pars) conf_intervals(pois_quad) #> Waiting for profiling to be done... #> Model: pois_glm_loglik  #>  #> 95% confidence intervals, adjusted loglikelihod with type = ''vertical''  #>  #> Symmetric: #>        lower     upper    #> alpha   0.89907   1.22747 #> beta    0.78986   1.20231 #> gamma  -0.12024   0.02199 #>  #> Profile likelihood-based: #>        lower    upper   #> alpha   0.8954   1.2232 #> beta    0.7877   1.1991 #> gamma  -0.1198   0.0222"},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Two-dimensional confidence regions — conf_region","title":"Two-dimensional confidence regions — conf_region","text":"Calculates (profile, necessary) loglikelihood pair parameters confidence regions can plotted using plot.confreg.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Two-dimensional confidence regions — conf_region","text":"","code":"conf_region(   object,   which_pars = NULL,   range1 = c(NA, NA),   range2 = c(NA, NA),   conf = 95,   mult = 2,   num = c(10, 10),   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Two-dimensional confidence regions — conf_region","text":"object object class \"chandwich\" returned adjust_loglik. which_pars vector length 2 specifying 2 (unfixed)   parameters confidence region required.   Can either numeric vector, specifying indices components   full parameter vector, character vector   parameter names, must subset supplied   par_names call adjust_loglik   produced object. which_pars must parameters common   attr(object, \"fixed_pars\").  which_pars must contain   unfixed parameters, .e. point profiling   unfixed parameters. which_pars supplied current model exactly   two free parameters, .e. attr(object, \"p_current\") = 2   which_pars set attr(object, \"free_pars\") = 2. range1, range2 Numeric vectors length 2.  Respective ranges (form c(lower, upper)) values which_pars[1] which_pars[2] profile. Missing values range1 /range2 filled using conf mult.  See details. conf numeric scalar (0, 100).  highest confidence level interest. relevant range1 /range2 completely specified.  event conf used, combination mult, try set grid parameter values include largest confidence region interest. mult numeric vector length 1 length which_pars. search profile loglikelihood-based confidence limits conducted corresponding symmetric confidence intervals (based approximate normal theory), extended factor corresponding component mult. num numeric vector length 1 2.  numbers values evaluate profile loglikelihood either side MLE. num[] relates which_pars[].  num length 1 num replicated length 2. type character scalar.  argument type function returned adjust_loglik, , type adjustment made independence loglikelihood function. ... arguments passed optim. may include gr, method, lower, upper control.  arguments appropriate optim, .e. methods::formalArgs(stats::optim), removed without warning.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Two-dimensional confidence regions — conf_region","text":"object class \"confreg\", list components grid1, grid2 Numeric vectors.   Respective values       which_pars[1] which_pars[2] grid       (profile) loglikelihood evaluated. max_loglik numeric scalar.  value value       loglikelihood maximum. prof_loglik 2 num + 1 2 num + 1       numeric matrix containing values (profile) loglikelihood. type character scalar. input type. which_pars numeric character vector.  input       which_pars.  which_pars numeric       supplemented parameter names, available       object. name character scalar. name model,       stored attr(object, \"name\").","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/conf_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Two-dimensional confidence regions — conf_region","text":"","code":"# -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names)  # \\donttest{ # Plots like those in Figure 4 of Chandler and Bate (2007) # (a) which_pars <- c(\"mu[0]\", \"mu[1]\") reg_1 <- conf_region(large, which_pars = which_pars) #> Waiting for profiling to be done... reg_none_1 <- conf_region(large, which_pars = which_pars, type = \"none\") #> Waiting for profiling to be done... plot(reg_1, reg_none_1)  # (b) which_pars <- c(\"sigma[0]\", \"sigma[1]\") reg_2 <- conf_region(large, which_pars = which_pars) #> Waiting for profiling to be done... reg_none_2 <- conf_region(large, which_pars = which_pars, type = \"none\") #> Waiting for profiling to be done... plot(reg_2, reg_none_2)  # (c) # Note: the naive and bivariate model contours are the reversed in the paper which_pars <- c(\"sigma[0]\", \"xi[0]\") reg_3 <- conf_region(large, which_pars = which_pars) #> Waiting for profiling to be done... reg_none_3 <- conf_region(large, which_pars = which_pars, type = \"none\") #> Waiting for profiling to be done... plot(reg_3, reg_none_3)  # }  # --------- Misspecified Poisson model for negative binomial data ----------  # ... following Section 5.1 of the \"Object-Oriented Computation of Sandwich # Estimators\" vignette of the sandwich package # https://cran.r-project.org/web/packages/sandwich/vignettes/sandwich-OOP.pdf  # Simulate data set.seed(123) x <- rnorm(250) y <- rnbinom(250, mu = exp(1 + x), size = 1) # Fit misspecified Poisson model fm_pois <- glm(y ~ x + I(x^2), family = poisson) summary(fm_pois)$coefficients #>                Estimate Std. Error   z value      Pr(>|z|) #> (Intercept)  1.06326821 0.04135723 25.709367 9.184267e-146 #> x            0.99607219 0.05353446 18.606186  2.862861e-77 #> I(x^2)      -0.04912373 0.02314608 -2.122335  3.380961e-02  # Contributions to the independence loglikelihood pois_glm_loglik <- function(pars, y, x) {   log_mu <- pars[1] + pars[2] * x + pars[3] * x ^ 2   return(dpois(y, lambda = exp(log_mu), log = TRUE)) } pars <- c(\"alpha\", \"beta\", \"gamma\") # Linear model (gamma fixed at 0) pois_lin <- adjust_loglik(pois_glm_loglik, y = y, x = x, par_names = pars,                           fixed_pars = \"gamma\") pois_vertical <- conf_region(pois_lin) #> Waiting for profiling to be done... pois_none <- conf_region(pois_lin, type = \"none\") #> Waiting for profiling to be done... plot(pois_none, pois_vertical, conf = c(50, 75, 95, 99), col = 2:1, lwd = 2,      lty = 1)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/logLik.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract log-likelihood for objects of class ","title":"Extract log-likelihood for objects of class ","text":"logLik method class \"chandwich\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/logLik.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract log-likelihood for objects of class ","text":"","code":"# S3 method for class 'chandwich' logLik(object, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/logLik.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract log-likelihood for objects of class ","text":"object object class \"chandwich\", result call adjust_loglik. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/logLik.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract log-likelihood for objects of class ","text":"object class \"logLik\": numeric scalar value equal maximised (independence) loglikelihood, , value independence loglikelihood MLE, attribute \"df\", gives number free parameters estimated.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/logLik.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract log-likelihood for objects of class ","text":"value maximised (independence) loglikelihood extracted attr(object, \"max_loglik\").  also equal object(attr(object, \"MLE\")).","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":null,"dir":"Reference","previous_headings":"","what":"The Generalised Extreme Value Log-Density Function — log_gev","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"Log-Density function generalised extreme value (GEV) distribution","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"","code":"log_gev(x, loc = 0, scale = 1, shape = 0)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"x Numeric vectors quantiles. loc, scale, shape Numeric scalars. Location, scale shape parameters. scale must positive.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"numeric vector value(s) log-density GEV distribution.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"assumed x, loc = \\(\\mu\\),  scale = \\(\\sigma\\) shape = \\(\\xi\\)  GEV density non-zero, .e.  \\(1 + \\xi (x - \\mu) / \\sigma > 0\\). check ,  scale > 0 performed function. distribution function GEV distribution parameters  loc = \\(\\mu\\), scale = \\(\\sigma\\) (>0)  shape = \\(\\xi\\)  $$F(x) = exp { - [1 + \\xi (x - \\mu) / \\sigma] ^ (-1/\\xi)} $$  \\(1 + \\xi (x - \\mu) / \\sigma > 0\\).  \\(\\xi = 0\\)  distribution function defined limit \\(\\xi\\) tends zero.  support distribution depends \\(\\xi\\):  \\(x <= \\mu - \\sigma / \\xi\\) \\(\\xi < 0\\);  \\(x >= \\mu - \\sigma / \\xi\\) \\(\\xi > 0\\);  \\(x\\) unbounded \\(\\xi = 0\\).  Note \\(\\xi < -1\\) GEV density function becomes infinite  \\(x\\) approaches \\(\\mu -\\sigma / \\xi\\) . See  https://en.wikipedia.org/wiki/Generalized_extreme_value_distribution  information.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"Jenkinson, . F. (1955) frequency distribution   annual maximum (minimum) meteorological elements.   Quart. J. R. Met. Soc., 81, 158-171.   Chapter 3: doi:10.1002/qj.49708134804 Coles, S. G. (2001) Introduction Statistical   Modeling Extreme Values, Springer-Verlag, London.   doi:10.1007/978-1-4471-3675-0_3","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/log_gev.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"The Generalised Extreme Value Log-Density Function — log_gev","text":"","code":"log_gev(1:4, 1, 0.5, 0.8) #> [1] -0.3068528 -1.7596424 -2.7021107 -3.3731334 log_gev(1:3, 1, 0.5, -0.2) #> [1] -0.3068528 -1.4279153 -5.7449245"},{"path":"https://github.com/paulnorthrop/chandwich/reference/owtemps.html","id":null,"dir":"Reference","previous_headings":"","what":"Oxford and Worthing annual maximum temperatures — owtemps","title":"Oxford and Worthing annual maximum temperatures — owtemps","text":"Annual maximum temperatures, degrees Fahrenheit, Oxford Worthing (England), period 1901 1980.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/owtemps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Oxford and Worthing annual maximum temperatures — owtemps","text":"","code":"owtemps"},{"path":"https://github.com/paulnorthrop/chandwich/reference/owtemps.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Oxford and Worthing annual maximum temperatures — owtemps","text":"dataframe 80 rows 2 columns, named Oxford Worthing.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/owtemps.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Oxford and Worthing annual maximum temperatures — owtemps","text":"Tabony, R. C. (1983) Extreme value analysis meteorology.  Meteorological Magazine, 112, 77-98.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/owtemps.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Oxford and Worthing annual maximum temperatures — owtemps","text":"Chandler, R. E. Bate, S. (2007). Inference clustered   data using independence loglikelihood. Biometrika,   94(1), 167-183. doi:10.1093/biomet/asm015","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for a chandwich object — plot.chandwich","title":"Plot diagnostics for a chandwich object — plot.chandwich","text":"plot method class \"chandwich\".  applicable object x attr(x, \"p_current\") = 1, .e. model one free parameter.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for a chandwich object — plot.chandwich","text":"","code":"# S3 method for class 'chandwich' plot(x, y, type = 1, legend = length(type) > 1, legend_pos = \"topleft\", ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for a chandwich object — plot.chandwich","text":"x object class \"chandwich\", result call adjust_loglik. y used. type integer vector, subset numbers 1:4. Indicates loglikelihoods plot: 1 \"vertical\" adjustment; 2 \"cholesky\" (horizontal adjustment); 3 \"spectral\" (horizontal adjustment); 4 adjustment, .e. based independence loglikelihood. legend logical scalar character vector.  supplied legend added plot.  legend character vector used argument legend legend.  Otherwise, .e. legend = TRUE argument type used. legend_pos position legend (required) specified using argument x legend. ... Additional arguments passed matplot   legend.  arguments col, lty   lwd used (consistent way)   matplot legend. argument xlim matplot   supplied MLE minus (lower) plus (upper)   standard errors used.  type include 4 adjusted   standard errors used.  Otherwise, larger adjusted   unadjusted standard errors used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics for a chandwich object — plot.chandwich","text":"Nothing returned.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.chandwich.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics for a chandwich object — plot.chandwich","text":"","code":"# ------------------------- Binomial model, rats data ----------------------  # Contributions to the independence loglikelihood binom_loglik <- function(prob, data) {   if (prob < 0 || prob > 1) {     return(-Inf)   }   return(dbinom(data[, \"y\"], data[, \"n\"], prob, log = TRUE)) } rat_res <- adjust_loglik(loglik = binom_loglik, data = rats, par_names = \"p\")  # Vertically adjusted loglikelihood only plot(rat_res)  # Three adjusted loglikelihoods and the independence loglikelihood plot(rat_res, type = 1:4)  # Plot over (0,1) and reposition the legend plot(rat_res, type = 1:4, xlim = c(0, 1), legend_pos = \"bottom\")"},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for a confint object — plot.confint","title":"Plot diagnostics for a confint object — plot.confint","text":"plot method class \"confint\". Plots (profile) loglikelihood parameter using values calculated conf_intervals. 4 different types loglikelihood (see argument type function returned adjust_loglik) may superimposed plot. default (add_lines = TRUE) confidence limits calculated conf_intervals indicated plot .","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for a confint object — plot.confint","text":"","code":"# S3 method for class 'confint' plot(   x,   y = NULL,   y2 = NULL,   y3 = NULL,   which_par = x$which_pars[1],   conf = x$conf,   add_lines = TRUE,   legend = any(c(!is.null(y), !is.null(y2), !is.null(y3))),   legend_pos = \"topleft\",   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for a confint object — plot.confint","text":"x, y, y2, y3 objects class \"confint\", results calls conf_intervals common model.  (profile) loglikelihood plotted object. which_par scalar specifying parameter plot produced.  Can either numeric scalar, specifying index component full parameter vector, character scalar parameter name.  former must x$which_pars, latter must names(x$which_pars). conf numeric vector values (0, 100).  add_lines = TRUE horizontal line added value conf.  conf supplied value stored x$conf used. add_lines logical scalar.  Whether add horizontal lines plot identify confidence limits.  one input \"confint\" object values confidence limits added horizontal axis. legend logical scalar character vector.  supplied legend added plot.  legend character vector used argument legend legend.  Otherwise, .e. legend = TRUE component type input object(s) x, y, y2, y3 used. legend_pos position legend (required) specified using argument x legend. ... Additional arguments passed matplot legend.  arguments col, lty lwd used (consistent way) matplot legend.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics for a confint object — plot.confint","text":"Nothing returned.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confint.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics for a confint object — plot.confint","text":"See examples conf_intervals.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confreg.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for a confreg object — plot.confreg","title":"Plot diagnostics for a confreg object — plot.confreg","text":"plot method class \"confreg\". Plots confidence regions pairs parameters using profile loglikelihood values calculated conf_region. 4 different types loglikelihood (see argument type function returned adjust_loglik) may superimposed plot.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confreg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for a confreg object — plot.confreg","text":"","code":"# S3 method for class 'confreg' plot(   x,   y = NULL,   y2 = NULL,   y3 = NULL,   conf = 95,   legend = any(c(!is.null(y), !is.null(y2), !is.null(y3))),   legend_pos = \"topleft\",   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confreg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for a confreg object — plot.confreg","text":"x, y, y2, y3 objects class \"confreg\", results calls conf_region common model common value which_pars.  Contours plotted object. conf numeric vector confidence levels, .e. numbers (0, 100).  confidence region contour plotted value conf. legend logical scalar character vector.  supplied legend added plot.  legend character vector used argument legend legend.  Otherwise, .e. legend = TRUE component type input object(s) x, y, y2, y3 used. legend_pos position legend (required) specified using argument x legend. ... Additional arguments passed contour legend.  arguments col, lty lwd used (consistent way) contour legend.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confreg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics for a confreg object — plot.confreg","text":"Nothing returned.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/plot.confreg.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot diagnostics for a confreg object — plot.confreg","text":"See examples conf_region.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method class \"chandwich\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'chandwich' print(x, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"chandwich\", result call adjust_loglik. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"argument x, invisibly,   print methods.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for objects of class ","text":"Just prints original call adjust_loglik   character vector giving names attributes   (produced using ls(attributes(x))) function returned   adjust_loglik.   view individual attribute called att_name use   attr(x, \"att_name\") attributes(x)$att_name.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method class \"compmod\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'compmod' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"compmod\", result call compare_models. digits integer. argument digits signif. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"argument x, invisibly,   print methods.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for objects of class ","text":"Prints name model, null (H0) alternative hypotheses (HA), test statistic, degrees freedom p-value. test based approximation detailed equations (18)-(20) Chandler Bate (2007), rather equation (17), stated.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.compmod.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for objects of class ","text":"See examples compare_models.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method class \"confint\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'confint' print(x, digits = max(3L, getOption(\"digits\") - 3L), ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"confint\", result call conf_intervals. digits integer. argument digits print.default. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"argument x, invisibly,   print methods.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print method for objects of class ","text":"Prints name model, details fixed parameters,   confidence level interval(s) whether   loglikelihood adjusted, symmetric (profile) likelihood   based intervals.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.confint.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for objects of class ","text":"See examples conf_intervals.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.summary.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for objects of class ","title":"Print method for objects of class ","text":"print method object x class \"summary.chandwich\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.summary.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for objects of class ","text":"","code":"# S3 method for class 'summary.chandwich' print(x, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.summary.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for objects of class ","text":"x object class \"summary.chandwich\", result call summary.chandwich. ... Additional arguments passed print.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.summary.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for objects of class ","text":"Prints numeric matrix 3 columns number rows   equal number parameters current model, .e.   attr(object, \"p_current\").   columns contain: maximum likelihood estimates (MLE), unadjusted   standard errors (SE) adjusted standard errors (adjSE).","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/print.summary.chandwich.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print method for objects of class ","text":"See examples adjust_loglik.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/profile_loglik.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile loglikelihood — profile_loglik","title":"Profile loglikelihood — profile_loglik","text":"Calculates profile loglikelihood subset model parameters. function provided primarily can called conf_intervals conf_region.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/profile_loglik.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile loglikelihood — profile_loglik","text":"","code":"profile_loglik(   object,   prof_pars = NULL,   prof_vals = NULL,   init = NULL,   type = c(\"vertical\", \"cholesky\", \"spectral\", \"none\"),   ... )"},{"path":"https://github.com/paulnorthrop/chandwich/reference/profile_loglik.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile loglikelihood — profile_loglik","text":"object object class \"chandwich\" returned adjust_loglik. prof_pars vector specifying subset (unfixed) parameters   profile. Can either numeric vector, specifying indices   components full parameter vector, character   vector parameter names, must subset supplied   par_names call adjust_loglik produced   object. prof_pars must parameters common   attr(object, \"fixed_pars\").  prof_pars must contain   unfixed parameters, .e. point profiling   unfixed parameters. prof_vals numeric vector.  Values parameters prof_pars.  prof_vals = NULL MLEs stored object parameters prof_pars used. init numeric vector initial estimates values parameters fixed prof_pars. length attr(object, \"p_current\") - length(prof_pars). init NULL wrong length relevant components MLE stored object used. type character scalar.  argument type function returned adjust_loglik, , type adjustment made independence loglikelihood function. ... arguments passed optim. may include gr, method, lower, upper control.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/profile_loglik.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile loglikelihood — profile_loglik","text":"numeric vector length 1.  value profile   loglikelihood.  returned object attribute \"free_pars\"   giving optimal values parameters remain   parameters prof_pars attr(object, \"fixed_pars\")   removed full parameter vector.    parameters, happens attempt made profile   non-fixed parameters, attribute present   value returned calculated using function object.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/profile_loglik.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Profile loglikelihood — profile_loglik","text":"","code":"# -------------------------- GEV model, owtemps data ----------------------- # ------------ following Section 5.2 of Chandler and Bate (2007) -----------  gev_loglik <- function(pars, data) {   o_pars <- pars[c(1, 3, 5)] + pars[c(2, 4, 6)]   w_pars <- pars[c(1, 3, 5)] - pars[c(2, 4, 6)]   if (isTRUE(o_pars[2] <= 0 | w_pars[2] <= 0)) return(-Inf)   o_data <- data[, \"Oxford\"]   w_data <- data[, \"Worthing\"]   check <- 1 + o_pars[3] * (o_data - o_pars[1]) / o_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   check <- 1 + w_pars[3] * (w_data - w_pars[1]) / w_pars[2]   if (isTRUE(any(check <= 0))) return(-Inf)   o_loglik <- log_gev(o_data, o_pars[1], o_pars[2], o_pars[3])   w_loglik <- log_gev(w_data, w_pars[1], w_pars[2], w_pars[3])   return(o_loglik + w_loglik) }  # Initial estimates (method of moments for the Gumbel case) sigma <- as.numeric(sqrt(6 * diag(var(owtemps))) / pi) mu <- as.numeric(colMeans(owtemps) - 0.57722 * sigma) init <- c(mean(mu), -diff(mu) / 2, mean(sigma), -diff(sigma) / 2, 0, 0)  # Log-likelihood adjustment of the full model par_names <- c(\"mu[0]\", \"mu[1]\", \"sigma[0]\", \"sigma[1]\", \"xi[0]\", \"xi[1]\") large <- adjust_loglik(gev_loglik, data = owtemps, init = init,                        par_names = par_names)  # Profile loglikelihood for xi1, evaluated at xi1 = 0 profile_loglik(large, prof_pars = \"xi[1]\", prof_vals = 0) #> [1] -446.0887 #> attr(,\"free_pars\") #>      mu[0]      mu[1]   sigma[0]   sigma[1]      xi[0]  #> 80.9917215  2.5067225  3.7828562  0.2433040 -0.2010567   # Model with xi1 fixed at 0 medium <- adjust_loglik(larger = large, fixed_pars = \"xi[1]\") # Profile loglikelihood for xi0, evaluated at xi0 = -0.1 profile_loglik(medium, prof_pars = \"xi[0]\", prof_vals = -0.1) #> [1] -446.3349 #> attr(,\"free_pars\") #>      mu[0]      mu[1]   sigma[0]   sigma[1]  #> 80.9256806  2.4551350  3.6790743  0.4088366"},{"path":"https://github.com/paulnorthrop/chandwich/reference/rats.html","id":null,"dir":"Reference","previous_headings":"","what":"Rat tumor data — rats","title":"Rat tumor data — rats","text":"Tumor incidence 71 groups rate Tarone (1982). matrix rat 71 rows 2 columns. row relates different group rats. first column (y) contains number rats tumors. second column (n) contains total number rats.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/rats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Rat tumor data — rats","text":"","code":"rats"},{"path":"https://github.com/paulnorthrop/chandwich/reference/rats.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Rat tumor data — rats","text":"matrix 71 rows 2 columns.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/rats.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Rat tumor data — rats","text":"Table 5.1 Gelman, ., Carlin, J. B., Stern, H. S. Dunson, D. B.,  Vehtari, . Rubin, D. B. (2013) Bayesian Data Analysis,  Chapman & Hall / CRC.   http://www.stat.columbia.edu/~gelman/book/data/rats.asc","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/rats.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Rat tumor data — rats","text":"Tarone, R. E. (1982) use historical information   testing trend proportions. Biometrics, 38,   215-220.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/summary.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarizing adjusted loglikelihoods — summary.chandwich","title":"Summarizing adjusted loglikelihoods — summary.chandwich","text":"summary method class \"chandwich\"","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/summary.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarizing adjusted loglikelihoods — summary.chandwich","text":"","code":"# S3 method for class 'chandwich' summary(object, digits = max(3, getOption(\"digits\") - 3L), ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/summary.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarizing adjusted loglikelihoods — summary.chandwich","text":"object object class \"chandwich\", result call adjust_loglik. digits integer. Used number formatting signif. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/summary.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarizing adjusted loglikelihoods — summary.chandwich","text":"Returns numeric matrix 3 columns number rows   equal number parameters current model, .e.   attr(object, \"p_current\").   columns contain: maximum likelihood estimates (MLE), unadjusted   standard errors (SE) adjusted standard errors (adjSE).","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/summary.chandwich.html","id":"examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarizing adjusted loglikelihoods — summary.chandwich","text":"See examples adjust_loglik.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/reference/vcov.chandwich.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the variance-covariance matrix for an object of class ","title":"Calculate the variance-covariance matrix for an object of class ","text":"vcov method class \"chandwich\".","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/vcov.chandwich.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the variance-covariance matrix for an object of class ","text":"","code":"# S3 method for class 'chandwich' vcov(object, complete = FALSE, adjusted = TRUE, ...)"},{"path":"https://github.com/paulnorthrop/chandwich/reference/vcov.chandwich.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the variance-covariance matrix for an object of class ","text":"object object class \"chandwich\", result call adjust_loglik. complete logical scalar.  complete = TRUE   full variance-covariance matrix returned, including fixed   using fixed_pars fixed_at call   adjust_loglik.  instance corresponding   elements matrix NA. Otherwise, variance-covariance   matrix free parameters returned. default complete = FALSE, sync   coef.chandwich. adjusted logical scalar.  adjusted = TRUE variance-covariance matrix estimated using sandwich estimator. Otherwise, inverse observed information MLE used. ... Additional optional arguments. present optional arguments used.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/vcov.chandwich.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the variance-covariance matrix for an object of class ","text":"numeric matrix.  dimensions named names   provided call adjust_loglik.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/reference/vcov.chandwich.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate the variance-covariance matrix for an object of class ","text":"variance-covariance matrix based attributes(object)$adjVC adjusted = TRUE attributes(object)$VC adjusted = FALSE. return estimate variance-covariance matrix free parameters.","code":""},{"path":[]},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-116","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.6","title":"chandwich 1.1.6","text":"CRAN release: 2023-08-25","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-6","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.6","text":"Create help file package correctly, alias chandwich-package. plot.confint() confidence limits now added horizontal axis cases one interval plotted. Activated 3rd edition testthat package","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-115","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.5","title":"chandwich 1.1.5","text":"CRAN release: 2021-10-30","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-5","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.5","text":"vignette references section DOIs rendered URLs hyperlinked.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-114","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.4","title":"chandwich 1.1.4","text":"CRAN release: 2021-07-02","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-4","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.4","text":"function conf_intervals() now stops evaluating profile loglikelihood required confidence limits estimated. conf_interals() initial estimates used profile loglikelihood reset searches lower confidence limits upper limits. cases may cause problems optimisations. corrected: initial estimates now reset. confint.chandwich() argument profile can used choose whether return confidence intervals based (adjusted) profile loglikelihood based approximate large sample normal theory. anova.chandwich() function modified enable comparison nested (adjusted) model objects, nesting explicitly created using argument fixed_pars adjust_loglikelihood(). documentation conf_intervals() updated: general nature argument num explained Details advice given one confidence limits found using default arguments. description argument parm documentation confint.chandwich(), which_pars corrected parm twice.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-113","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.3","title":"chandwich 1.1.3","text":"CRAN release: 2020-11-07","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-3","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.3","text":"object returned adjust_loglik() extra attribute loglikVecMLE, vector containing contributions individual observations independence log-likelihood evaluated MLE. isTRUE() used GEV example avoid potential problems owing possibility NAs.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-112","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.2","title":"chandwich 1.1.2","text":"CRAN release: 2019-07-11","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-2","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.2","text":"typo meant text Value section description confint.chandwich() cut short. corrected. adjust_loglik() p = 1 user supplies scalar H instead matrix error thrown dimnames() just results returned. calculations correct, code modified trivially avoid error. function returned adjust_loglik code perform horizontal adjustment loglikelihood changed x_star <- mle + .vector(C %*% (x - mle)): using .vector() avoids potential warning ensuring vector + vector, vector + matrix. bugs plot.chandwich(), plot.confreg() plot.confint() produced error user tried set legend using legend argument. bugs corrected.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-111","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.1","title":"chandwich 1.1.1","text":"CRAN release: 2018-11-28","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-1","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.1","text":"attribute nobs added object returned adjust_loglik() attribute object returned logLik.chandwich(). compare_models() parameter names () passed (adjusted) loglikelihood function, case required inside loglikelihood function. bug plot method objects class “confreg” returned conf_region(): parameters named user ? appeared twice console, requiring user press return twice plot produced. corrected.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"chandwich-110","dir":"Changelog","previous_headings":"","what":"chandwich 1.1.0","title":"chandwich 1.1.0","text":"CRAN release: 2018-09-10","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"new-features-1-1-0","dir":"Changelog","previous_headings":"","what":"New features","title":"chandwich 1.1.0","text":"adjust_loglik additional arguments mle, H V allow user option supply MLE, Hessian independence loglikelihood (H) variance vector cluster-specific contributions score vector (V), evaluated MLE, rather estimating within adjust_loglik. anova S3 method class “chandwich” added. compares two nested models using adjusted likelihood ratio tests successive pairs models, using compare_models(). confint S3 method class “chandwich” added. based fairly trivial call conf_intervals(). S3 methods coef, vcov logLik class “chandwich” added.","code":""},{"path":"https://github.com/paulnorthrop/chandwich/news/index.html","id":"bug-fixes-and-minor-improvements-1-1-0","dir":"Changelog","previous_headings":"","what":"Bug fixes and minor improvements","title":"chandwich 1.1.0","text":"bug compare_models() fixed. bug resulted error cases argument larger corresponded simplification full model element parameter fixed element +n, n > 0, fixed. Estimated unadjusted (VC) adjusted (adjVC) variance-covariance matrices free model parameters now available object returned adjust_loglik(). documentation argument approx compare_models() edited make clearer smaller supplied approx = FALSE used regardless value supplied approx call compare_models(). parameter names supplied adjust_loglik() (via par_names) fixed_pars numeric names parameters fixed_pars now also inferred case larger model supplied via larger. means output compare_models() now use parameter name, rather parameter number. numeric fixed_pars supplied compare_models() names parameters fixed_pars inferred, available supplied object larger. summary method class “evpost” now set according Section 8.1 R FAQ (https://cran.r-project.org/doc/FAQ/R-FAQ.html). Introducing chandwich vignette typo definition HA corrected. expression given inverse HA, HA.","code":""}]
